---
title: "Grade analysis"
author: "Amandine Godefroy"
format: html
---

```{r}
#| message: false
#| warning: false
here::i_am("TP4.Rproj")
library(here)
library(vroom)
library(tidyr)
library(dplyr)
library(ggplot2)
```

# Question 1

Data loading
```{r}
#| message: false
grades <- vroom(here("grades.csv"))
```

# Question 2

```{r}
stats_exam <- grades |> summarize(min_exap = min(Exam, na.rm = TRUE), max_exam = max(Exam, na.rm = TRUE), avg_exam = mean(Exam, na.rm = TRUE), med_exam = median(Exam, na.rm = TRUE))

knitr::kable(stats_exam)
```

# Question 3

```{r}
no_exam <- grades |> count(is.na(Exam))
```
There are `r no_exam[2,2]` students who did not take the exam.

# Question 4

Graphical representation of the distribution of grades at the exam.
```{r}
Exam_woNA <- grades |> filter(!is.na(Exam))

Exam_woNA |> ggplot(aes(x = Exam)) +
  geom_histogram(binwidth = 0.5)
```

## Question 5

```{r}
nber_stdts_group <- grades |> count(Group) |> group_by(Group)

knitr::kable(nber_stdts_group)
```

# Question 6

```{r}
grades |> ggplot(aes(x = Group, fill = Group)) +
  geom_bar()
```
# Question 7

```{r}
ggplot(grades, aes(x = Exam, fill = Group)) +
  geom_histogram(bins = 20) +
  geom_rug(alpha = 0.03, linewidth = 1.5) +
  facet_wrap(~Group)
```

```{r}
ggplot(grades, aes(x = Exam, y=Group, fill = Group)) +
  geom_boxplot()
```

# Question 8

```{r}
na_exam_per_group <- grades %>%
  group_by(Group) %>%
  summarise(nber_na_exam = sum(is.na(Exam)))

knitr::kable(na_exam_per_group)
```
# Question 9

```{r}
all_Groups <- inner_join(grades, na_exam_per_group, by=join_by(Group))

ggplot(all_Groups, aes(x = Group, y = nber_na_exam)) +
  geom_col()
```
# Question 10

```{r}
new_grades <- grades %>% pivot_longer(
  cols = Exam | starts_with("MCQ_") | starts_with("Online_MCQ_"),
  names_to = "name",
  values_to = "value"
)
```

# Question 11

```{r}
na_exam_per_student <- new_grades %>%
  group_by(Id) %>%
  summarise(nber_na_grades = sum(is.na(value)))

knitr::kable(na_exam_per_student)
```

